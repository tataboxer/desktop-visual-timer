
# 安静闹钟 v1.0 产品需求文档 (PRD)

## 1. 产品概述

### 产品愿景
打造一款现代化、专业级的桌面闹钟和定时器应用，专注于提高工作效率和时间管理能力。

### 目标用户
- 需要精确时间管理的办公人员
- 使用番茄工作法的效率爱好者
- 需要多重提醒方式的用户
- 追求简洁优雅界面的用户

## 2. 功能需求

### 2.1 功能性需求 (Functional Requirements)

#### 核心闹钟功能
- **FR1**: 用户可以设置精确到秒的单次闹钟
- **FR2**: 用户可以设置按"天"为周期的重复性闹钟（支持任意星期组合）
- **FR3**: 用户可以通过现代化ON/OFF按钮快速启用/禁用闹钟
- **FR4**: 用户可以删除不需要的闹钟
- **FR5**: 用户可以为闹钟添加描述性标签
- **FR6**: 用户可以点击闹钟项目进行编辑

#### 快捷计时器功能
- **FR7**: 用户可以启动预设时长的快捷倒计时器（番茄钟、休息计时）
- **FR8**: 用户可以在设置中自定义计时器默认时长
- **FR9**: 用户可以同时运行多个倒计时器
- **FR10**: 用户可以实时查看活跃计时器的剩余时间
- **FR11**: 用户可以随时取消正在运行的计时器
- **FR12**: 用户可以通过托盘菜单快速启动计时器

#### 多重提醒系统
- **FR13**: 当闹钟触发时，系统托盘图标必须闪烁提醒
- **FR14**: 当闹钟触发时，必须弹出Windows Toast通知
- **FR15**: 当闹钟触发时，可选择显示屏幕视觉效果（边缘闪光或全屏闪烁）
- **FR16**: 用户可以配置视觉效果的类型、强度和持续时间
- **FR17**: 用户可以在设置界面测试视觉效果

#### 设置系统
- **FR18**: 用户可以控制系统通知的开关
- **FR19**: 用户可以设置界面行为（托盘最小化、启动选项）
- **FR20**: 用户可以自定义计时器默认时长
- **FR21**: 用户可以调整性能设置（低功耗模式、检查间隔）
- **FR22**: 用户可以配置视觉效果设置
- **FR23**: 用户可以一键重置所有设置为默认值
- **FR24**: 所有设置必须持久化保存

#### 数据持久化
- **FR25**: 用户设置的所有闹钟必须被持久化存储
- **FR26**: 应用设置必须在重启后保持
- **FR27**: 一次性闹钟触发后自动删除

### 2.2 非功能性需求 (Non-Functional Requirements)

#### 性能要求
- **NFR1**: 应用在后台待机时CPU占用率 < 1%
- **NFR2**: 应用内存占用 < 50MB
- **NFR3**: 应用启动时间 < 3秒
- **NFR4**: 界面响应时间 < 100ms

#### 兼容性要求
- **NFR5**: 支持Windows 10/11系统
- **NFR6**: 支持Python 3.7+环境
- **NFR7**: 支持高DPI显示器

#### 可用性要求
- **NFR8**: 界面必须完全中文本地化
- **NFR9**: 核心功能必须在离线状态下工作
- **NFR10**: 必须提供完整的错误处理和用户反馈

## 3. 用户界面设计目标

### 3.1 整体UX愿景
界面设计遵循"清晰、直观、高效"的原则，采用现代化卡片式设计，基于8px网格系统，提供优雅的用户体验。

### 3.2 设计原则
- **简洁性**: 避免不必要的干扰元素，突出核心功能
- **一致性**: 统一的颜色、字体和间距规范
- **响应性**: 智能的空间分配和元素对齐
- **可访问性**: 支持高DPI显示器，清晰的视觉层次

### 3.3 核心交互模式
- **单次点击**: 常用操作（如启动快捷计时）通过单次点击完成
- **即时反馈**: 所有操作都有即时的视觉反馈
- **点击编辑**: 点击闹钟项目直接进入编辑模式
- **现代化切换**: ON/OFF按钮提供直观的状态切换

### 3.4 核心界面与视图

    **A. 主窗口 (Main Window)**

    ```
    +-------------------------------------------------------------------------+
    | 安静闹钟 v1.0                                            [设置⚙] [-][口][x] |
    +-------------------------------------------------------------------------+
    | ┌─ 闹钟列表 ─────────────────┐ │ ┌─ 编辑闹钟 ─────────────────────────┐ |
    | │                           │ │ │                                   │ |
    | │  [+ 新建闹钟]       [⚙]   │ │ │  当前时间: 14:25:30               │ |
    | │                           │ │ │                                   │ |
    | │ ┌─────────────────────────┐ │ │ │  闹钟时间: [14]:[30]:[00]         │ |
    | │ │ 08:30:00                │ │ │ │                                   │ |
    | │ │ 每日晨会                │ │ │ │  标签: [项目周会            ]     │ |
    | │ │ 重复•一二三四五    [ON][×]│ │ │ │                                   │ |
    | │ └─────────────────────────┘ │ │ │  重复:                            │ |
    | │ ┌─────────────────────────┐ │ │ │  [√]一 [√]二 [√]三 [√]四 [√]五    │ |
    | │ │ 14:30:00                │ │ │ │  [ ]六 [ ]日                      │ |
    | │ │ 项目周会                │ │ │ │                                   │ |
    | │ │ 单次            [OFF][×]│ │ │ │                                   │ |
    | │ └─────────────────────────┘ │ │ │                    [保存] [取消]  │ |
    | └───────────────────────────┘ │ └───────────────────────────────────┘ |
    +-------------------------------+-----------------------------------------+
    | ┌─ 快捷计时 ─────────────────────────────────────────────────────────┐ |
    | │ [🍅 专注 25分钟] [🚶 休息 15分钟] [☕ 休息 5分钟]    活跃计时器:     │ |
    | │                                                   番茄工作法: 24:35 │ |
    | └─────────────────────────────────────────────────────────────────┘ |
    +-------------------------------------------------------------------------+
    ```

    **B. 系统托盘右键菜单 (System Tray Context Menu)**

    ```
    +---------------------------+
    | 显示/隐藏窗口             |
    |---------------------------|
    | 快捷计时器 >              | -> [🍅 专注 25分钟]
    |                           | -> [🚶 休息 15分钟]
    |                           | -> [☕ 休息 5分钟]
    |---------------------------|
    | 退出                      |
    +---------------------------+
    
    闹钟触发时的菜单:
    +---------------------------+
    | 取消闹钟                  |
    |---------------------------|
    | 显示                      |
    |---------------------------|
    | 退出                      |
    +---------------------------+
    ```

    **C. 设置界面 (Settings Window)**

    ```
    +-----------------------------------------------------------------------+
    | 应用设置                                                    [×]        |
    +-----------------------------------------------------------------------+
    | [通知设置] [界面设置] [计时器设置] [性能设置] [视觉效果]              |
    +-----------------------------------------------------------------------+
    | 通知设置:                                                             |
    |                                                                       |
    | [√] 启用系统通知                                                      |
    | [ ] 启用通知声音 (暂未实现)                                           |
    |                                                                       |
    | Windows通知说明:                                                      |
    | • 通知显示时长由Windows系统设置控制                                   |
    | • 可在Windows设置 > 系统 > 通知中调整                                |
    |                                                                       |
    +-----------------------------------------------------------------------+
    | [恢复默认设置]                                            [关闭]      |
    +-----------------------------------------------------------------------+
    ```

    **D. 视觉效果设置标签页**

    ```
    +-----------------------------------------------------------------------+
    | 视觉效果设置:                                                         |
    |                                                                       |
    | [√] 启用屏幕视觉提醒效果                                              |
    |                                                                       |
    | 效果类型: [边缘闪光 ▼]                                                |
    | 效果持续时间 (秒): [5.0]                                              |
    | 效果强度: [中 ▼]                                                      |
    |                                                                       |
    |                                            [测试效果]                 |
    |                                                                       |
    | 视觉效果说明:                                                         |
    | • 边缘闪光：屏幕边缘细红线闪烁，不遮挡内容                           |
    | • 全屏闪烁：整个屏幕轻微闪烁提醒                                     |
    | • 强度设置：低/中/高 对应不同的视觉强度                              |
    +-----------------------------------------------------------------------+
    ```

## 4. 技术架构

### 4.1 核心组件
- **Application**: 主应用程序类，协调所有组件
- **AppGUI**: 图形用户界面，基于tkinter
- **TimerEngine**: 定时器引擎，处理闹钟和倒计时逻辑
- **TrayController**: 系统托盘控制器
- **DataManager**: 数据持久化管理
- **SettingsManager**: 设置管理器
- **NotificationManager**: 通知管理器
- **ScreenEffectsManager**: 屏幕视觉效果管理器

### 4.2 数据存储
- **alarms.json**: 闹钟数据存储
- **settings.json**: 应用设置存储

### 4.3 依赖库
- **tkinter**: GUI框架
- **pystray**: 系统托盘支持
- **schedule**: 定时任务调度
- **Pillow**: 图像处理
- **plyer**: 跨平台通知

## 5. 实现状态

### 5.1 已完成功能 (v1.0)
- ✅ 精确到秒的闹钟设置
- ✅ 单次和重复性闹钟
- ✅ 现代化ON/OFF切换按钮
- ✅ 快捷倒计时器（番茄钟、休息计时）
- ✅ 多计时器同时运行
- ✅ 系统托盘集成和图标闪烁
- ✅ Windows Toast通知
- ✅ 屏幕视觉效果（边缘闪光、全屏闪烁）
- ✅ 完善的设置系统（5个标签页）
- ✅ 数据持久化
- ✅ 性能优化（低功耗模式）
- ✅ 现代化卡片式UI设计
- ✅ 完整的中文本地化

### 5.2 未来功能规划
- 🔄 通知声音支持
- 🔄 开机自启动
- 🔄 自动开始休息计时器
- 🔄 更多视觉效果类型
- 🔄 数据导入导出
- 🔄 快捷键支持

## 6. 验收标准

### 6.1 功能验收
- 所有FR需求必须100%实现
- 所有NFR需求必须达到指标要求
- 界面必须与设计稿保持一致

### 6.2 性能验收
- CPU占用率 < 1%（低功耗模式）
- 内存占用 < 50MB
- 启动时间 < 3秒
- 界面响应时间 < 100ms

### 6.3 兼容性验收
- Windows 10/11 完全兼容
- 高DPI显示器正常显示
- 多显示器环境正常工作

---

**文档版本**: v1.0  
**最后更新**: 2024年  
**状态**: 已完成实现
