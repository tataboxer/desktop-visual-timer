# 窗口跨屏移动功能 - 使用指南

> **状态**: ✅ 功能已完成并可正常使用  
> **版本**: v1.2  
> **最后更新**: 2025年1月  
> **默认热键**: F9

> 版本: 1.0  
> 更新日期: 2024年  

## 🚀 快速开始

### 1. 功能启用
窗口跨屏移动功能默认已启用。如需调整，请编辑 `settings.json` 文件：

```json
{
    "window_management": {
        "enabled": true,
        "hotkey": "F12",
        "move_strategy": "center",
        "handle_maximized": true,
        "exclude_fullscreen": true,
        "debug_mode": false
    }
}
```

### 2. 基本使用
1. **启动程序**：运行 `牛马生物钟.bat` 或 `python src/main.py`
2. **移动窗口**：按下 `F12` 键（默认快捷键）
3. **当前活动窗口**将自动移动到下一个显示器

## ⚙️ 配置选项详解

### 基本设置

| 配置项 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| `enabled` | boolean | `true` | 是否启用窗口管理功能 |
| `hotkey` | string | `"F12"` | 触发窗口移动的快捷键 |
| `move_strategy` | string | `"center"` | 窗口定位策略 |
| `handle_maximized` | boolean | `true` | 是否处理最大化窗口 |
| `exclude_fullscreen` | boolean | `true` | 是否排除全屏应用 |
| `debug_mode` | boolean | `false` | 是否启用调试模式 |

### 快捷键配置

#### 支持的快捷键格式：
- **功能键**：`F1`, `F2`, ..., `F12`
- **字母键**：`A`, `B`, ..., `Z`
- **数字键**：`0`, `1`, ..., `9`
- **特殊键**：`Space`, `Tab`, `Enter`, `Esc`, `Delete`, `Insert`, `Home`, `End`, `PageUp`, `PageDown`
- **组合键**：`Ctrl+F12`, `Alt+F9`, `Shift+F12`, `Ctrl+Alt+M`

#### 推荐的快捷键：
```json
"hotkey": "F12"         // 默认，可能与浏览器开发者工具冲突
"hotkey": "Ctrl+F12"    // 带修饰键，冲突概率较低
"hotkey": "F9"          // 较少使用的功能键
"hotkey": "Alt+F9"      // 组合键
"hotkey": "Ctrl+Alt+M"  // 字母组合键
```

### 移动策略

#### `center` - 居中策略（默认）
窗口移动到目标显示器后，在显示器中央显示。
```json
"move_strategy": "center"
```

#### `relative` - 相对位置策略
保持窗口在显示器中的相对位置不变。
```json
"move_strategy": "relative"
```

#### `smart` - 智能策略
根据窗口大小自动选择最佳策略：
- 大窗口（占屏幕80%以上）：使用居中策略
- 小窗口：使用相对位置策略
```json
"move_strategy": "smart"
```

## 🖥️ 多显示器支持

### 支持的配置
- **双显示器**：主显示器 ↔ 副显示器
- **三显示器及以上**：按显示器索引循环移动
- **不同分辨率**：自动适配不同分辨率的显示器
- **动态检测**：支持运行时插拔显示器

### 显示器检测
程序会自动检测所有连接的显示器，并按以下顺序排列：
1. 主显示器（索引0）
2. 副显示器（索引1, 2, 3...）

窗口移动遵循循环顺序：0 → 1 → 2 → ... → 0

## 🎯 窗口处理规则

### 支持的窗口类型
- ✅ 普通应用窗口
- ✅ 最大化窗口（可配置）
- ✅ 无边框窗口
- ✅ 置顶窗口

### 排除的窗口类型
- ❌ 最小化窗口
- ❌ 系统窗口（任务栏、桌面等）
- ❌ 无标题窗口
- ❌ 全屏应用（可配置）

### 特殊处理

#### 最大化窗口
当 `handle_maximized` 为 `true` 时：
1. 自动还原窗口
2. 移动到目标显示器
3. 在新显示器上重新最大化

#### 全屏应用
当 `exclude_fullscreen` 为 `true` 时：
- 跳过全屏游戏和应用
- 避免干扰全屏体验

## 🔧 故障排除

### 常见问题

#### 1. 快捷键不响应
**可能原因**：
- 快捷键被其他程序占用
- 程序权限不足
- 依赖库未正确安装

**解决方案**：
```json
// 尝试更换快捷键
"hotkey": "Ctrl+F9"

// 启用调试模式查看日志
"debug_mode": true
```

#### 2. 窗口移动失败
**可能原因**：
- 目标窗口权限过高
- 窗口类型不支持
- 单显示器环境

**解决方案**：
- 检查是否为多显示器环境
- 尝试移动其他窗口
- 查看控制台日志信息

#### 3. 最大化窗口异常
**可能原因**：
- 某些应用不支持程序化最大化
- 显示器分辨率差异过大

**解决方案**：
```json
// 禁用最大化窗口处理
"handle_maximized": false
```

#### 4. 性能问题
**症状**：
- CPU占用过高
- 响应延迟

**解决方案**：
```json
// 关闭调试模式
"debug_mode": false

// 检查是否有其他全局快捷键程序冲突
```

### 日志查看

启用调试模式查看详细日志：
```json
"debug_mode": true
```

日志信息包括：
- 显示器检测结果
- 窗口移动操作
- 错误和异常信息
- 性能统计

### 权限问题

如果遇到权限相关错误：
1. **以管理员身份运行**程序
2. **检查防火墙**设置
3. **确认依赖库**正确安装

## 📋 快捷键冲突检测

程序内置常见快捷键冲突检测：

### 系统快捷键冲突
- `F1`: Windows帮助
- `F11`: 全屏模式
- `F12`: 浏览器开发者工具
- `Alt+F4`: 关闭窗口

### 推荐的无冲突快捷键
1. `F9` - 较少使用
2. `Ctrl+F9` - 组合键
3. `Alt+F9` - 替代组合
4. `Shift+F12` - Shift组合
5. `Ctrl+Alt+M` - 字母组合

## 🔄 配置热更新

程序支持运行时配置更新：
1. 修改 `settings.json` 文件
2. 程序自动检测配置变化
3. 重新加载快捷键和设置

**注意**：某些配置可能需要重启程序才能生效。

## 🎮 使用技巧

### 1. 工作流优化
- 将常用应用放在主显示器
- 使用快捷键快速整理窗口布局
- 配合任务栏使用提高效率

### 2. 多显示器布局建议
- **编程环境**：代码编辑器 + 浏览器/文档
- **设计工作**：设计软件 + 参考资料
- **数据分析**：表格 + 图表/报告

### 3. 快捷键选择建议
- **单人使用**：使用简单的功能键（如F9）
- **团队环境**：使用组合键避免冲突
- **游戏玩家**：避免使用游戏常用键

## 📞 技术支持

如果遇到问题：
1. 查看本文档的故障排除部分
2. 启用调试模式查看详细日志
3. 检查 `docs/window_manager_design.md` 技术文档
4. 运行测试脚本验证功能

## 🔮 未来功能

计划中的增强功能：
- 窗口布局预设
- 多窗口批量移动
- 智能窗口排列
- 虚拟桌面支持
- 配置界面GUI